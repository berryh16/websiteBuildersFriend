<!DOCTYPE html>

<html lang="en">

<!-- This is a comment -->
	<head>
		<title>Website Builders Friend</title>

		<meta charset="utf-8">
  		<meta name="viewport" content="width=device-width, initial-scale=1">
  		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
		<script src="https://pagecdn.io/lib/ace/1.4.7/ace.js" crossorigin="anonymous" integrity="sha256-C7DTYRJLG+B/VEzHGeoPMw699nsTQYPAXHKXZb+q04E=" ></script>
		<script src="http://www.skulpt.org/js/skulpt.min.js" type="text/javascript" /></script>
 		<script src="http://www.skulpt.org/js/skulpt-stdlib.js" type="text/javascript" /></script>

	<style type="text/css" media="screen">


		/* Add a black background color to the top navigation */
		.topnav {
		background-color: #333;
		overflow: hidden;
		}

		/* Style the links inside the navigation bar */
		.topnav a {
  		float: left;
  		color: #f2f2f2;
  		text-align: center;
  		padding: 14px 16px;
  		text-decoration: none;
  		font-size: 17px;
		}

		/* Change the color of links on hover */
		.topnav a:hover {
  		background-color: #ddd;
  		color: black;
		}

		/* Add a color to the active/current link */
		.topnav a.active {
  		background-color: #4CAF50;
  		color: white;
		}

		#editor {
   		    height: 800px;
		    width: 625px;
		    float: left;
   		}

   		#editor2 {
   		    height: 800px;
		    width: 625px;
   		}

		#return{
		    height: 300px;
		    float: right;
		}


		.button {
  		   background-color:#4CAF50;
		}
		
		
	</style>
	</head>
	<body style="background-color : #000">
                		
<div class="container-fluid" style="color:#4CAF50">
		<h1>Website Builders Friend</h1>

		<div class="topnav">
		<a href="siteBuilderFriend">Home</a>
		<a href="html">HTML</a>
		<a href="bootstrap">BootStrap</a>
  		<a href="javascript">JavaScript</a>
		<a href="jquery">Jquery</a>
		<a class="active" href="flask">Flask &amp PostgreSQL</a>
		</div> 
    <div class="panel panel-default">
        <div class="panel-heading">
			<div class="col-sm-4">
			</div>

			<div class="col-sm-4">
        	<h2>Flask. God damn more Python</h2>
			<p>Flask is a microweb frame work built with python. It basically is the back-end for a web application.
			<br>You can define app routes for handling what happens when the user changes pages or submits something.
			<br>Flask can also be used for handling any database you application uses.
			</p>
			</div>

        </div>
			<p></p>
	</div>
        <div class="panel-body">
			<div class="row">
				<div class="col-sm-4">
					<h2>main.py</h2>
            		<div id="editor">import os
from flask import Flask, request, render_template, session
from flask_sqlalchemy import SQLAlchemy
from werkzeug.utils import redirect

import util

# get current app directory
basedir = os.path.abspath(os.path.dirname(__file__))

# create a Flask instance
app = Flask(__name__)
# define SQLAlchemy URL, a configuration parameter
app.config['SQLALCHEMY_DATABASE_URI'] = \
    'sqlite:///' + os.path.join(basedir, 'data.sqlite')
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

db = SQLAlchemy(app)


@app.route('/database')
def index():
    bands, songs = util.getDB()
    return render_template('index.html', bands=bands, songs=songs)


@app.route('/')
@app.route('/siteBuilderFriend')
def start():
    return render_template('siteBuilderFriend.html')


@app.route('/dbstart')
def dbStart():
    util.doIndex()
    return render_template('index.html')


@app.route('/html')
def html():
    return render_template('html.html')


@app.route('/addBand', methods=['GET', 'POST'])
def addBand():
    name = ""
    genre = ""
    if request.method == 'POST':
        name = request.form['bname']
        genre = request.form['genre']
        print(name)
        print(genre)
        util.addBand(name, genre)
        return redirect('database')
    return render_template('addBand.html')


@app.route('/addSong', methods=['GET', 'POST'])
def addSong():
    name = ""
    leng = ""
    band = ""
    if request.method == 'POST':
        name = request.form['sname']
        leng = request.form['slen']
        band = request.form['band']
        util.addSong(name, leng, band)
        return redirect('database')
    return render_template('addSong.html')


@app.route('/bootstrap')
def boot():
    return render_template('bootstrap.html')


@app.route('/jquery')
def jq():
    return render_template('jquery.html')


@app.route('/javascript')
def javascript():
    return render_template('javascript.html')


@app.route('/flask')
def flask():
    return render_template('flask.html')


# default page for 404 error
@app.errorhandler(404)
def page_not_found(e):
    return render_template('404_error.html'), 404


# default page for 500 error
@app.errorhandler(500)
def server_error(e):
    print(e)
    return render_template('500_error.html'), 500


if __name__ == '__main__':
    app.debug = True
    ip = '127.0.0.1'
    app.run(host=ip)

</div><!--Needs to be hear so that we don't get stupid shit in editor on page-->
				</div>
				<div class="col-sm-4">
					<h2>util.py</h2>
            		<div id="editor2"># The db object instantiated from the class SQLAlchemy represents the database and
# provides access to all the functionality of Flask-SQLAlchemy.
from flask import session
from flask_sqlalchemy import SQLAlchemy

from main import db


class Band(db.Model):
    # __tablename__ class variable defines the name of the table in the database
    __tablename__ = 'band'

    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(64))
    genre = db.Column(db.String(64))

    # give them a readable string representation that can be used for debugging and testing purposes
    def __repr__(self):
        return 'Band: %s, %s' % (self.name, self.genre)


class Song(db.Model):
    __tablename__ = 'song'

    song_id = db.Column(db.Integer, primary_key=True)
    song_name = db.Column(db.String(64))
    song_length = db.Column(db.String(64))
    song_band = db.Column(db.String(64))

    def __repr__(self):
        return 'Song %s, %s, %s' % (self.song_name, self.song_length, self.song_band)


def addBand(name, genre):
    db.session.add(Band(name=name, genre=genre))
    db.session.commit()


def addSong(name, leng, band):
    db.session.add(Song(song_name=name, song_length=leng, song_band=band))
    db.session.commit()

def doIndex():
    # locates all the subclasses of db.Model and creates corresponding tables in the database for them
    # brute-force solution to avoid updating existing database tables to a different schema
    db.drop_all()
    db.create_all()
    db.session.commit()


def getDB():
    band = Band.query.all()
    song = Song.query.all()
    return band, song


</div><!--Needs to be hear so that we don't get stupid shit in editor on page-->
				</div>

				<div class="col-sm-4">
					<h2>Database tool ex.</h2>
    				<div id="return">
						<script type="text/javascript">
							window.onload=function(){
 							document.getElementById("btn").click();
							};
						</script>
    				</div>
				</div>
			</div>
		</div>
		<div>
			<p></p>
			<button onclick="runCode()" id="btn" class="button" style="dsplay: none; outline: 0;"></button>
		</div>
	</div>


	<script>
    	var editor = ace.edit("editor");
    	editor.setTheme("ace/theme/monokai");
    	editor.session.setMode("ace/mode/python");
	</script>

			<script>
    	var editor2 = ace.edit("editor2");
    	editor2.setTheme("ace/theme/monokai");
    	editor2.session.setMode("ace/mode/python");
	</script>

	<script>
		function runCode(){
			$('#return').html("<iframe src=dbstart width='600px' height='800px'></iframe>");
		}
	</script>

</div>

	</body>
</html>
